Image:
  Os: {{ os }}
HeadNode:
  InstanceType: c5n.18xlarge
  Networking:
    SubnetId: {{ public_subnet_id }}
  Ssh:
    KeyName: {{ key_name }}
  Imds:
    Secured: {{ imds_secured }}
  Iam:
    S3Access:
      - BucketName: aws-parallelcluster-dev-hanwenli-scalingtest
        EnableWriteAccess: true
  CustomActions:
    OnNodeConfigured:
      Script: s3://aws-parallelcluster-dev-hanwenli-scalingtest/scripts/post.head.sh
      Args:
        - s3://aws-parallelcluster-dev-hanwenli-scalingtest/scripts
Scheduling:
  Scheduler: {{ scheduler }}
  SlurmSettings:
    ScaledownIdletime: 2
  SlurmQueues:
    - Name: compute
      ComputeResources:
        - Name: cit
          InstanceType: {{ compute_instance_type }}
          MinCount: 0
          MaxCount: 3000
      Networking:
        SubnetIds:
          - {{ private_subnet_id }}
      Iam:
        S3Access:
          - BucketName: aws-parallelcluster-dev-hanwenli-scalingtest
            EnableWriteAccess: false
      CustomActions:
        OnNodeStart:
          Script: s3://aws-parallelcluster-dev-hanwenli-scalingtest/scripts/pre.compute.sh
        OnNodeConfigured:
          Script: s3://aws-parallelcluster-dev-hanwenli-scalingtest/scripts/post.compute.sh
Monitoring:
  Logs:
    CloudWatch:
      Enabled: true
      RetentionInDays: 14
SharedStorage:
  - MountDir: /shared
    Name: fsx
    StorageType: FsxLustre
    FsxLustreSettings:
      StorageCapacity: 2400
  - MountDir: /ebs
    Name: ebs
    StorageType: Ebs
  - MountDir: /efs
    Name: efs
    StorageType: Efs
